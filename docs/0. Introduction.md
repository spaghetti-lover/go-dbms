# Introduction

## What is database

![alt text](image.png)

- Transport:

  - **Cluster Communication**: Manage communication between nodes.
  - **Client Communication**: Receive query from users.

- Query Processor:

  - **Query Cache**: Store result of queries
  - **Query Parser**: Parse and check syntax error
  - **Query Optimizer**: Remove redundant and choose execution plan

- Execution Engine:

  - **Remote Execution**
  - **Local Execution**

- Storage Engine:

  - **Transaction Manager**: Manage transaction
  - **Lock Manager**: Manage lock to ensure data integrity when there are concurrent transactions
  - **Access Method / Index data structure**: Defines how data is physically stored, retrieved, and manipulated on disk (B+ Tree, Heap files)
  - **Buffer Manager**: Buffer to store data pages to increase query speed
  - **Recovery Manager**: Maintain WAL to restore data

- Note:
  - In this project, I will implement all of these features except the cluster communication and remote execution since it is quite complicated

## Why we need it

- Store data in more structured way

## What we will build

### Feature

- Query Cache
- Query Parser
- Query Optimizer
- Local Execution
- Transaction Manager
- Lock Manager
- Access Method (B+ Tree, LSM Tree)
- Recovery Manager (WAL)

### Techstack

- Go

### Folder structure

```
database-from-scratch/
│
├── README.md                      # Overview, features, setup
├── docs/                          # Documentation
│   ├── architecture.md            # Nội dung hiện tại của bạn
│   ├── query-language.md          # SQL syntax support
│   ├── design-decisions.md        # Technical choices
│   └── images/
│       └── architecture.png
│
├── cmd/                           # Entry points
│   ├── server/
│   │   └── main.go               # Database server
│   └── cli/
│       └── main.go               # CLI client
│
├── pkg/                          # Public libraries
│   └── protocol/                 # Wire protocol
│
├── internal/                     # Private application code
│   │
│   ├── transport/               # Transport Layer
│   │   ├── client_comm.go       # Client communication handler
│   │   └── protocol.go          # Message protocol
│   │
│   ├── query/                   # Query Processor
│   │   ├── cache/
│   │   │   ├── cache.go         # Query cache implementation
│   │   │   └── lru.go           # LRU eviction policy
│   │   ├── parser/
│   │   │   ├── lexer.go         # Tokenizer
│   │   │   ├── parser.go        # SQL parser
│   │   │   └── ast.go           # Abstract syntax tree
│   │   └── optimizer/
│   │       ├── optimizer.go     # Query optimizer
│   │       ├── rules.go         # Optimization rules
│   │       └── planner.go       # Execution plan
│   │
│   ├── execution/               # Execution Engine
│   │   ├── executor.go          # Main executor
│   │   ├── operators/           # Query operators
│   │   │   ├── scan.go
│   │   │   ├── filter.go
│   │   │   ├── join.go
│   │   │   └── aggregate.go
│   │   └── plan.go              # Physical plan
│   │
│   ├── storage/                 # Storage Engine
│   │   ├── transaction/
│   │   │   ├── manager.go       # Transaction manager
│   │   │   └── isolation.go     # Isolation levels
│   │   ├── lock/
│   │   │   ├── manager.go       # Lock manager
│   │   │   └── deadlock.go      # Deadlock detection
│   │   ├── index/               # Access Methods
│   │   │   ├── btree/
│   │   │   │   ├── btree.go
│   │   │   │   └── node.go
│   │   │   └── lsm/
│   │   │       ├── lsm.go
│   │   │       └── memtable.go
│   │   ├── buffer/
│   │   │   ├── pool.go          # Buffer pool manager
│   │   │   └── page.go          # Page structure
│   │   ├── recovery/
│   │   │   ├── wal.go           # Write-ahead log
│   │   │   └── checkpoint.go    # Checkpoint manager
│   │   └── disk/
│   │       ├── manager.go       # Disk manager
│   │       └── page.go          # Page layout
│   │
│   └── common/                  # Shared utilities
│       ├── types.go             # Common types
│       ├── config.go            # Configuration
│       └── errors.go            # Error definitions
│
├── test/                        # Integration tests
│   ├── query_test.go
│   ├── transaction_test.go
│   └── recovery_test.go
│
├── scripts/                     # Utility scripts
│   ├── benchmark.sh
│   └── setup.sh
│
├── examples/                    # Usage examples
│   └── quickstart.go
│
├── go.mod
├── go.sum
├── Makefile                     # Build commands
└── .gitignore
```
